= provide(:title, "#{pluralize(@properties.count, "apartment")} found")

.properties_index
  .properties_index__header
    = render "search"

  .properties_index__content
    #map.map
    #search_result.search_result
      = render "search_result"

scss:
  
  .properties_index {
    .mapboxgl-popup {
      max-width: 150px;
      max-height: 300px;
      overflow-y: auto;
    }
    
    .btn.btn-outline-secondary {
      color: #666;
    }
  }
  
  .properties_index__content {
    position: absolute;
    height: 100%; 
    width: 100%;
    .map {
      position: absolute; 
      height: 100%; 
      width: 100%;
    }
    .search_result {
      position: absolute;
      height: 100%; 
      width: 100%;
      max-height: 100vh; 
      overflow-y: auto;
      padding: 0.5rem 1rem;
    }
  }


javascript:
  // Pass JSON data to frontend.
  var properties = #{ raw Property.properties_json_for_map(@properties) }

  // Create a map initializing with that data.
  window.App.maps.currentMap = new window.App.maps.PropertiesMap(properties[0].lngLat, properties);


  //---
  //---


  // Toggle map.
  $('#map_toggle').on('click', function() {
    $('#map').show();
    $('#search_result').hide();
  })
  
  // Toggle search_result.
  $('#search_result_toggle').on('click', function() {
    $('#search_result').show();
  })

  // Close modal when clicking on submit.
  $('#advanced_search_submit').on('click', function() {
    $('#advanced_search_close').trigger("click");
  })
